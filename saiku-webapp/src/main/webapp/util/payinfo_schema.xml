<?xml version="1.0"?>
<Schema name="payinfo_schema">
<Cube name="payinfo_cube_busi_payway">  
    <!-- 事实表(fact table) -->  
    <Table name="FACT_PAYINFO" />  
    <Dimension name="业务线" foreignKey="BUSI_KEY">
        <Hierarchy name="BUSI_TYPE" hasAll="true" primaryKey="BUSI_KEY">
            <Table name="DIM_BUSI"></Table>
            <Level name="BUSI_TYPE" column="BUSI_TYPE"/>
        </Hierarchy>

        <Hierarchy name="BUSI_TYPE_ID" hasAll="true" primaryKey="BUSI_KEY">
            <Table name="DIM_BUSI"></Table>
            <Level name="BUSI_TYPE_ID" column="BUSI_TYPE_ID"/>
        </Hierarchy>

        <Hierarchy name="OTATYPE" hasAll="true" primaryKey="BUSI_KEY">
            <Table name="DIM_BUSI"></Table>
            <Level name="OTATYPE" column="OTATYPE" type="Numeric"></Level>
        </Hierarchy>
    </Dimension>

    <Dimension name="支付方式" foreignKey="PAY_WAY_KEY">
        <Hierarchy hasAll="true" primaryKey="PAY_WAY_KEY">
            <Table name="DIM_PAYWAY"></Table>
            <Level name="PAY_WAY" column="PAY_WAY"></Level>
        </Hierarchy>
    </Dimension>

    <Measure name="订单数" column="UNIQUE_KEY" aggregator="count" datatype="Integer" />
    <Measure name="总支付金额" column="PAY_AMOUNT" aggregator="sum" datatype="Numeric" />
    <Measure name="支付次数" column="BATCH_PAYMENT_ID" aggregator="count" datatype="Integer" />
    <Measure name="用户数" column="USER_ID" aggregator="count" datatype="Integer" />
    <Measure name="gid数" column="GID" aggregator="count" datatype="Integer" />
    <CalculatedMember name="金额/订单" dimension="Measures" formula="[Measures].[总支付金额] / [Measures].[订单数]">
        <CalculatedMemberProperty name="FORMAT_STRING" value="#,###.00"/>
    </CalculatedMember>
</Cube>  
</Schema>
